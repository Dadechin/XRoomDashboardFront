<template>
  <SidebarMenu />
  
  <div class="dashboard-page">
    <div class="content">
      <!-- Top Header -->
      <AppHeader pageTitle="ØªÛŒÙ… Ù‡Ø§" />


       
      <!-- Description -->
      <div class="section-description">
          <div class="section-title">Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ø¹Ø¶Ø§</div>
        <p>
Ø¯Ø± Ø§ÛŒÙ† Ø¨Ø®Ø´ Ø¨Ù‡ Ø´Ù…Ø§ Ø§Ù…Ú©Ø§Ù† Ù…ÛŒâ€ŒØ¯Ù‡Ø¯ ØªØ§ Ø§ØªØ§Ù‚â€ŒÙ‡Ø§ØŒ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ Ùˆ Ø¬Ù„Ø³Ø§Øª Ø±Ø§ Ø¨Ø§ Ù‡Ù…Ú©Ø§Ø±Ø§Ù† Ø®ÙˆØ¯ Ø¨Ù‡ Ø§Ø´ØªØ±Ø§Ú© Ø¨Ú¯Ø°Ø§Ø±ÛŒØ¯. Ø¯Ø± Ø§ÛŒÙ† Ø¨Ø®Ø´ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ ØªÛŒÙ… Ø®ÙˆØ¯ Ø±Ø§ Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ù†ÛŒØ¯.        </p>
      </div>


     




















<!-- Tab Buttons -->
<div class="tab-buttons">
  <button
    :class="['tab-btn', activeTab === 'users' ? 'active' : '']"
    @click="activeTab = 'users'"
  >Ú©Ø§Ø±Ø¨Ø±Ø§Ù†</button>
   <button
  :class="['tab-btn', activeTab === 'buy-subscription' ? 'active' : '']"
  @click="activeTab = 'buy-subscription'"
>
  Ø®Ø±ÛŒØ¯ Ø§Ø´ØªØ±Ø§Ú©
</button>
  <button
    :class="['tab-btn', activeTab === 'membership' ? 'active' : '']"
    @click="activeTab = 'membership'"
  >Ø§Ø´ØªØ±Ø§Ú© Ù‡Ø§</button>
  <button
    :class="['tab-btn', activeTab === 'details' ? 'active' : '']"
    @click="activeTab = 'details'"
  >Ø¬Ø²Ø¦ÛŒØ§Øª</button>
 

</div>



<!-- Tab Content -->
<div v-if="activeTab === 'users'">
  <div class="card license-card">
    <span>Ù„Ø§ÛŒØ³Ù†Ø³ Ù‡Ø§ÛŒ Ù‚Ø§Ø¨Ù„ Ø§Ø³ØªÙØ§Ø¯Ù‡ :</span>
    <div class="buy-subscription">Ø®Ø±ÛŒØ¯ Ø§Ø´ØªØ±Ø§Ú©</div>
  </div>

  <div class="user-cards">
    <div class="user-card add-card" @click="openAddUserDialog">
      <span class="add-text">â• Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ú©Ø§Ø±Ø¨Ø± Ø¬Ø¯ÛŒØ¯</span>
    </div>
    
    
    <div class="user-card" v-for="(user, index) in userList" :key="index">
  <div class="user-card-header">
    <img :src="user.avatar" class="user-avatar" alt="avatar" />
    <div class="user-info-box">
      <div class="user-name">{{ user.name }}</div>
      <div class="user-email">{{ user.email }}</div>
      <div class="user-role">{{ user.role }}</div>
      <div class="user-version">{{ user.version }}</div>
    </div>
  </div>
  <div class="user-footer">
    <span>Ø§Ú©Ø§Ù†Øª XRoom</span>
    <div class="user-actions">
      <button><i class="icon">ğŸ—‘ï¸</i></button>
      <button><i class="icon">âš™ï¸</i></button>
    </div>
  </div>
</div>

    
  </div>
</div>


<div v-if="activeTab === 'membership'" class="tab-content">
  <div class="access-container">
  <!-- Title Section -->
  <div class="access-header" style="
    background: white;
    border-radius: 20px;
    padding: 20px;"
    >

    <img :src="require('@/assets/img/lock Icon.png')" alt="logout"  class="lock-icon"/>

    <div class="header-text">
      <h3>ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ø¯Ø³ØªØ±Ø³ÛŒ XRoom</h3>
      <p>Ø¯Ø³ØªØ±Ø³ÛŒ Ú©Ø§Ù…Ù„ Ø¨Ù‡ Ø§Ù…Ú©Ø§Ù†Ø§Øª XRoom Ø¨Ø¯ÙˆÙ† ÙˆØ§ØªØ±Ù…Ø§Ø±Ú©</p>
    </div>
  

      <!-- Subscription Button -->
      <button class="primary-button">
    <img style="margin-left:10px" :src="require('@/assets/img/hand.png')" alt="logout"  />
        
         Ø§Ù†ØªØ®Ø§Ø¨ Ø·Ø±Ø­ Ø§Ø´ØªØ±Ø§Ú©ÛŒ
      </button>


  </div>


  <!-- Info Cards -->
  <div class="info-cards">
    <!-- Billing Info -->
    <div class="info-card">
      <h4>Ø¬Ø²Ø¦ÛŒØ§Øª ØµÙˆØ±ØªØ­Ø³Ø§Ø¨</h4>
      <p>
        Ø§ØµÙÙ‡Ø§Ù†ØŒ Ø®ÛŒØ§Ø¨Ø§Ù† ÙˆØ­ÛŒØ¯ØŒ Ù†Ø¨Ø´ Ø®ÛŒØ§Ø¨Ø§Ù† Ø­Ø³ÛŒÙ† Ø¢Ø¨Ø§Ø¯ØŒ Ù…Ø¬ØªÙ…Ø¹ Ø¹Ø³Ú¯Ø±ÛŒ Û³ØŒ ÙˆØ§Ø­Ø¯ Û³<br />
        Û¸Û±Û·ÛµÛ¹Û´Û¹Û¹Û¹Û±<br />
        Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³: Û°Û¹Û³Û·Û¹Û¸Û¹Û¸Û¶Û²Û³<br />
        Ø§ÛŒÙ…ÛŒÙ„: aminimperator@gmail.com
      </p>
      <button class="secondary-button">ÙˆÛŒØ±Ø§ÛŒØ´ Ø¬Ø²Ø¦ÛŒØ§Øª ØµÙˆØ±ØªØ­Ø³Ø§Ø¨</button>
    </div>

    <!-- Membership Info -->
    <div class="info-card">
      <h4>Ø¹Ø¶ÙˆÛŒØª Ù‡Ø§</h4>
      <p>Ù‡Ù†ÙˆØ² Ù…Ø¬ÙˆØ²ÛŒ ÙØ¹Ø§Ù„ Ù†ÛŒØ³Øª. Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø´Ù…Ø§ Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù†Ø¯ Ø§Ø² XRoom Ø¨Ø§ ÙˆØ§ØªØ±Ù…Ø§Ø±Ú© Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†Ù†Ø¯.</p>
      <button class="secondary-button">Ù…Ø¯ÛŒØ±ÛŒØª Ø¹Ø¶ÙˆÛŒØª Ù‡Ø§</button>
    </div>

    <!-- Payment Method -->
    <div class="info-card">
      <h4>Ø±ÙˆØ´ Ù¾Ø±Ø¯Ø§Ø®Øª</h4>
      <p>Ù‡ÛŒÚ† Ø±ÙˆØ´ Ù¾Ø±Ø¯Ø§Ø®ØªÛŒ Ø¨Ø±Ø§ÛŒ ØµÙˆØ±ØªØ­Ø³Ø§Ø¨ Ù…Ø±ØªØ¨Ø· Ù†ÛŒØ³Øª.</p>
    </div>
  </div>
</div>

</div>

<div v-if="activeTab === 'details'" class="tab-content">
  <div class="card">Ø¬Ø²Ø¦ÛŒØ§Øª ØªÛŒÙ… Û±</div>
  <div class="card">Ø¬Ø²Ø¦ÛŒØ§Øª ØªÛŒÙ… Û²</div>
</div>


<div v-if="activeTab === 'buy-subscription'" class="tab-content">
  <div class="buy-subscription-container">










    <div style="text-align: center; margin-bottom: 20px;">
      <label for="memberCount" style="margin-left: 10px;">ØªØ¹Ø¯Ø§Ø¯ Ú©Ø§Ø±Ø¨Ø±Ø§Ù†:</label>
      <select
        id="memberCount"
        v-model.number="memberCount"
        @change="selectedPlan && selectPlan(selectedPlan.name === 'Ù‡ÙØªÚ¯ÛŒ' ? 'weekly' : selectedPlan.name === 'Ù…Ø§Ù‡Ø§Ù†Ù‡' ? 'monthly' : 'yearly')"
        style="padding: 8px 12px; border-radius: 8px; border: 1px solid #ccc;"
      >
        <option v-for="count in availableMemberOptions" :key="count" :value="count">
          {{ count }} Ú©Ø§Ø±Ø¨Ø±
        </option>
      </select>
    </div>











    <h3 style="text-align: center; margin-bottom: 20px;">Ù„Ø·ÙØ§ Ù†ÙˆØ¹ Ø§Ø´ØªØ±Ø§Ú© Ø®ÙˆØ¯ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</h3>

    <div style="display: flex; justify-content: center; gap: 20px; flex-wrap: wrap;">
      <div class="plan-card">
        <h4>Ù‡ÙØªÚ¯ÛŒ</h4>
        <p>Û²ÛµÛ°Ù¬Û°Û°Û° ØªÙˆÙ…Ø§Ù†<br><small>Ø¨Ø±Ø§ÛŒ ÛŒÚ© Ú©Ø§Ø±Ø¨Ø±ØŒ Ø¯Ø± Ù‡ÙØªÙ‡</small></p>
        <button class="primary-button" @click="selectPlan('weekly')">Ø§Ù†ØªØ®Ø§Ø¨ Ø·Ø±Ø­ Ø§Ø´ØªØ±Ø§Ú©</button>
      </div>

      <div class="plan-card">
        <h4>Ù…Ø§Ù‡Ø§Ù†Ù‡</h4>
        <p>Û¶Û·Û°Ù¬Û°Û°Û° ØªÙˆÙ…Ø§Ù†<br><small>Ø¨Ø±Ø§ÛŒ ÛŒÚ© Ú©Ø§Ø±Ø¨Ø±ØŒ Ø¯Ø± Ù‡ÙØªÙ‡</small></p>
        <button class="primary-button" @click="selectPlan('monthly')">Ø§Ù†ØªØ®Ø§Ø¨ Ø·Ø±Ø­ Ø§Ø´ØªØ±Ø§Ú©</button>
      </div>

      <div class="plan-card">
        <h4>Ø³Ø§Ù„Ø§Ù†Ù‡</h4>
        <p>Û´Ù¬Û¶Û°Û°Ù¬Û°Û°Û° ØªÙˆÙ…Ø§Ù†<br><small>Ø¨Ø±Ø§ÛŒ ÛŒÚ© Ú©Ø§Ø±Ø¨Ø±ØŒ Ø¯Ø± Ù‡ÙØªÙ‡</small></p>
        <button class="primary-button" @click="selectPlan('yearly')">Ø§Ù†ØªØ®Ø§Ø¨ Ø·Ø±Ø­ Ø§Ø´ØªØ±Ø§Ú©</button>
      </div>
    </div>

    <!-- ÙØ§Ú©ØªÙˆØ± -->
    <div v-if="selectedPlan" class="invoice-box" style="margin-top: 40px; background: white; padding: 20px; border-radius: 12px; max-width: 400px; margin-right: auto; margin-left: auto;">
      <h4 style="margin-bottom: 16px;">Ù¾ÛŒØ´â€ŒÙØ§Ú©ØªÙˆØ± Ø§Ø´ØªØ±Ø§Ú© {{ selectedPlan.name }}</h4>
      <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
        <span>Ù‚ÛŒÙ…Øª Ù¾Ø§ÛŒÙ‡:</span>
        <span>{{ selectedPlan.price.toLocaleString() }} ØªÙˆÙ…Ø§Ù†</span>
      </div>
      <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
        <span>Ù…Ø§Ù„ÛŒØ§Øª (Û¹Ùª):</span>
        <span>{{ selectedPlan.tax.toLocaleString() }} ØªÙˆÙ…Ø§Ù†</span>
      </div>
      <div style="display: flex; justify-content: space-between; font-weight: bold; font-size: 16px; margin-bottom: 20px;">
        <span>Ù…Ø¨Ù„Øº Ù‚Ø§Ø¨Ù„ Ù¾Ø±Ø¯Ø§Ø®Øª:</span>
        <span>{{ selectedPlan.total.toLocaleString() }} ØªÙˆÙ…Ø§Ù†</span>
      </div>

      <button class="primary-button" style="width: 100%;" @click="pay">Ù¾Ø±Ø¯Ø§Ø®Øª</button>
    </div>

  </div>
</div>




















      

 


     
  </div>
  </div>
















  <dialog ref="addUserDialog" class="add-user-dialog">
  <div class="dialog-header">
    <button class="close-btn" @click="closeAddUserDialog">âœ•</button>
    <h3>Ú©Ø§Ø±Ø¨Ø± Ø¬Ø¯ÛŒØ¯</h3>
  </div>
  <div class="dialog-body">
    <h4>Ø¯Ø¹ÙˆØª Ú©Ø§Ø±Ø¨Ø± Ø¬Ø¯ÛŒØ¯</h4>
    <p style="    line-height: 45px;">Ú©Ø§Ø±Ø¨Ø± ÛŒÚ© Ø§ÛŒÙ…ÛŒÙ„ Ø¯Ø¹ÙˆØª Ø¨Ø±Ø§ÛŒ ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø­Ø³Ø§Ø¨ Ø®ÙˆØ¯ Ø¯Ø±ÛŒØ§ÙØª Ù…ÛŒâ€ŒÚ©Ù†Ø¯.</p>
    <form class="form-fields" @submit.prevent="submitNewUser">
      <div class="form-row">
        <label>Ù†Ø§Ù…  </label>
        <input v-model="newUser.first_name" required />
      </div>
      <div class="form-row">
        <label>Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ</label>
        <input v-model="newUser.last_name" required />
      </div>
      
      
      <div class="form-row">
        <label>Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³</label>
        <input v-model="newUser.phone" />
      </div>
      <div class="form-row">
        <label>Ù¾Ø³ÙˆØ±Ø¯ </label>
        <input type="password" v-model="newUser.password" />
      </div>
      
      <div class="dialog-actions">
        <button type="submit" class="confirm-btn">ØªØ§ÛŒÛŒØ¯</button>
        <button type="button" class="cancel-btn" @click="closeAddUserDialog">Ø¨Ø§Ø²Ú¯Ø´Øª</button>
      </div>
    </form>
  </div>
</dialog>









 



</template>

<script>
import 'video.js/dist/video-js.css';
import '@videojs/themes/dist/sea/index.css';
import '@google/model-viewer'
import SidebarMenu from '@/components/SidebarMenu.vue'
import axios from 'axios';

 
 import 'video.js/dist/video-js.css';
import AppHeader from '@/components/Header.vue';

export default {
  name: 'DashboardPage',
  components: {
    SidebarMenu,
    
    AppHeader,

  },
  data() {
    return {
      memberCount: 5,
      availableMemberOptions: [5, 10, 20, 100],

      newUser: {
      first_name: '',
      last_name: '',
      phone: '',
      password: '',
      isAdmin: false,
      hasAccess: false,

      }
      ,

    selectedPlan: null,
    plans: {
      weekly: { name: 'Ù‡ÙØªÚ¯ÛŒ', price: 250000 },
      monthly: { name: 'Ù…Ø§Ù‡Ø§Ù†Ù‡', price: 670000 },
      yearly: { name: 'Ø³Ø§Ù„Ø§Ù†Ù‡', price: 4600000 }
    },

      // ... existing data ...
      userList: [
  {
    name: 'Ø¯Ø§Ù†ÛŒØ§Ù„ Ù¾Ú˜ÙˆÙ‡Ø´ Ú©ÛŒØ§',
    email: 'aminimperator@gmail.com',
    role: 'Ù†Ø³Ø®Ù‡ Ø¢Ø²Ù…Ø§ÛŒØ´ÛŒ',
    version: '',
    avatar: 'https://models.readyplayer.me/681f59760bc631a87ad25172.png',
  },
  {
    name: 'Ø§Ù…ÛŒÙ† Ø±Ù…Ø¶Ø§Ù†ÛŒ',
    email: 'aminimperator@gmail.com',
    role: 'Ù…Ø¯ÛŒØ±',
    version: 'Ù†Ø³Ø®Ù‡ Ø¢Ø²Ù…Ø§ÛŒØ´ÛŒ',
    avatar: 'https://models.readyplayer.me/681f59760bc631a87ad25172.png',
  },
  {
    name: 'Ù†ÙˆÛŒØ¯ Ø±Ù…Ø¶Ø§Ù†ÛŒ',
    email: 'aminimperator@gmail.com',
    role: 'Ù…Ø¯ÛŒØ±',
    version: 'Ù†Ø³Ø®Ù‡ Ø¢Ø²Ù…Ø§ÛŒØ´ÛŒ',
    avatar: 'https://models.readyplayer.me/681f59760bc631a87ad25172.png',
  }
]
,
      activeTab: 'users',

      previewUrl: '',
    currentPreviewIndex: null,
    currentPreviewType: null,
    videoOptions: {
        autoplay: false,
        controls: true,
        sources: [{
          type: 'video/mp4',
          src: '' // Will be set dynamically
        }]
      },
    
      userData: {
        customer: {},
        user: {
          first_name: '',
          last_name: ''
        },
        images: [],
        pdfs: [],
        videos: [],
        glbs: []
      },
      newFileName: '',
      selectedFile: null,
      uploading: false,
      baseUrl: 'http://194.62.43.230:8000',
      currentUploadType: 'image',
      dialogTitle: 'Ø¢Ù¾Ù„ÙˆØ¯ ÙØ§ÛŒÙ„ Ø¬Ø¯ÛŒØ¯',
      fileAccept: '*/*'
    }
  },
  created() {
    this.fetchUserData();
  },
  methods: {

    
    
     selectPlan(planKey) {
  const plan = this.plans[planKey];
  if (!plan) return;

  const base = plan.price * this.memberCount;
  const tax = Math.round(base * 0.09);

  this.selectedPlan = {
    ...plan,
    basePrice: base,
    tax,
    total: base + tax
  };
      } 
    ,
  pay() {
  alert(`Ù¾Ø±Ø¯Ø§Ø®Øª Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯ Ø¨Ø±Ø§ÛŒ ${this.memberCount} Ú©Ø§Ø±Ø¨Ø±`);
  this.selectedPlan = null;
},



    openAddUserDialog() {
  this.$refs.addUserDialog.showModal();
},
closeAddUserDialog() {
  this.$refs.addUserDialog.close();
},
submitNewUser() {
  // Ø§ÛŒÙ†Ø¬Ø§ Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒ Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ API Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒ
  console.log('Ú©Ø§Ø±Ø¨Ø± Ø¬Ø¯ÛŒØ¯:', this.newUser);
  alert('Ú©Ø§Ø±Ø¨Ø± Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯');
  this.closeAddUserDialog();
}
,
    handleBackdropClick(event) {
    // Check if click was directly on the dialog element (backdrop)
    if (event.target === this.$refs.filePreviewDialog) {
      this.closePreviewDialog();
    }
  },
    openPreviewDialog(type, index, url) {
      if (type === 'video') {
        this.videoOptions.sources[0].src = url;
        this.$nextTick(() => {
          this.$refs.filePreviewDialog?.showModal();
        });
      }
      if (!this.$refs.filePreviewDialog) {
      console.error('Dialog element not found');
      return;
    }
    
    this.currentPreviewType = type;
    this.currentPreviewIndex = index;
    this.previewUrl = url;
    // Special handling for video
     
    this.currentPreviewType = type;
    this.currentPreviewIndex = index;
    
    if (type === 'video') {
      this.videoOptions.sources[0].src = url;
      this.videoOptions.poster = this.getVideoThumbnail();
      this.previewUrl = url;
    } else {
      this.previewUrl = url;
    }
    
    this.$nextTick(() => {
      this.$refs.filePreviewDialog?.showModal();
    });

    if (type === 'image') {
      this.previewImageUrl = url;
      this.previewPdfUrl = '';
    } else if (type === 'pdf') {
      this.previewPdfUrl = url;
      this.previewImageUrl = '';
    }
    
    // this.$refs.imagePreviewDialog.showModal();
    this.$refs.filePreviewDialog.showModal();

  },
  getVideoThumbnail(videoUrl) {
    // You can implement a proper thumbnail generation here
    // For now, we'll just return a placeholder
    videoUrl = 'https://cdn-icons-png.flaticon.com/512/2839/2839038.png'
    return videoUrl;
  },
  closePreviewDialog() {
    // Safely access the dialog reference
    const dialog = this.$refs.filePreviewDialog;
    
    if (dialog && typeof dialog.close === 'function') {
      dialog.close();
    } else {
      console.warn('Dialog reference not found or close method unavailable');
    }
    
    // Reset preview state
    this.previewUrl = '';
    this.currentPreviewIndex = null;
    this.currentPreviewType = null;
  },
  async downloadFile() {
    const url = this.currentPreviewType === 'image' 
      ? this.previewImageUrl 
      : this.previewPdfUrl;
    
    if (!url) return;
    
    try {
      const response = await fetch(url);
      const blob = await response.blob();
      const downloadUrl = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = downloadUrl;
      
      // Set appropriate filename
      if (this.currentPreviewType === 'image') {
        a.download = `image-${new Date().getTime()}.${url.split('.').pop()}`;
      } else if (this.currentPreviewType === 'pdf') {
        a.download = `document-${new Date().getTime()}.pdf`;
      }
      
      document.body.appendChild(a);
      a.click();
      window.URL.revokeObjectURL(downloadUrl);
      document.body.removeChild(a);
    } catch (error) {
      console.error('Error downloading file:', error);
      alert('Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø§Ù†Ù„ÙˆØ¯ ÙØ§ÛŒÙ„');
    }
  },
  
  async deleteFile() {
    if (this.currentPreviewIndex === null || !this.currentPreviewType) return;
    
    try {
      const token = localStorage.getItem('token');
      let deleteUrl = '';
      let itemId = '';
      let fileArray = [];
      
      switch(this.currentPreviewType) {
        case 'image':
          fileArray = this.userData.images;
          itemId = fileArray[this.currentPreviewIndex].id;
          deleteUrl = `${this.baseUrl}/deleteImage/${itemId}/`;
          break;
        case 'pdf':
          fileArray = this.userData.pdfs;
          itemId = fileArray[this.currentPreviewIndex].id;
          deleteUrl = `${this.baseUrl}/deletePdf/${itemId}/`;
          break;
        case 'video':
          fileArray = this.userData.videos;
          itemId = fileArray[this.currentPreviewIndex].id;
          deleteUrl = `${this.baseUrl}/deleteVideo/${itemId}/`;
          break;
        case 'glb':
          fileArray = this.userData.glbs;
          itemId = fileArray[this.currentPreviewIndex].id;
          deleteUrl = `${this.baseUrl}/deleteGlb/${itemId}/`;
          break;
      }
      
      await axios.delete(deleteUrl, {
        headers: {
          'Authorization': `Token ${token}`
        }
      });
      
      this.closePreviewDialog();
      await this.fetchUserData();
      alert('ÙØ§ÛŒÙ„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø­Ø°Ù Ø´Ø¯');
    } catch (error) {
      console.error('Error deleting file:', error);
      alert('Ø®Ø·Ø§ Ø¯Ø± Ø­Ø°Ù ÙØ§ÛŒÙ„');
    }
  },
    async fetchUserData() {
      try {
        const token = localStorage.getItem('token');
        
        const response = await axios.get(`${this.baseUrl}/getInfo`, {
          headers: {
            'Authorization': `Token ${token}`
          }
        });
        
        this.userData = response.data;
      } catch (error) {
        console.error('Error fetching user data:', error);
      }
    },
    getFullImageUrl(relativePath) {
      if (!relativePath) return '';
      return `${this.baseUrl}${relativePath}`;
    },
    formatDate(dateString) {
      if (!dateString) return '';
      const date = new Date(dateString);
      return date.toLocaleDateString('fa-IR');
    },
    openDialog(type) {
      this.currentUploadType = type;
      
      switch(type) {
        case 'image':
          this.dialogTitle = 'Ø¢Ù¾Ù„ÙˆØ¯ ØªØµÙˆÛŒØ± Ø¬Ø¯ÛŒØ¯';
          this.fileAccept = 'image/*';
          break;
        case 'pdf':
          this.dialogTitle = 'Ø¢Ù¾Ù„ÙˆØ¯ ÙØ§ÛŒÙ„ PDF';
          this.fileAccept = '.pdf';
          break;
        case 'video':
          this.dialogTitle = 'Ø¢Ù¾Ù„ÙˆØ¯ ÙˆÛŒØ¯ÛŒÙˆ';
          this.fileAccept = 'video/*';
          break;
        case 'glb':
          this.dialogTitle = 'Ø¢Ù¾Ù„ÙˆØ¯ Ù…Ø¯Ù„ 3D';
          this.fileAccept = '.glb';
          break;
      }
      
      this.$refs.newFileDialog.showModal();
    },
    closeDialog() {
      this.newFileName = '';
      this.selectedFile = null;
      this.$refs.newFileDialog.close();
    },
    handleFileChange(event) {
      this.selectedFile = event.target.files[0];
    },
    async uploadFile() {
      if (!this.selectedFile) return;
      
      this.uploading = true;
      
      const formData = new FormData();
      // formData.append('file', this.selectedFile);
      formData.append('name', this.newFileName || this.selectedFile.name);
      


         
        switch(this.currentUploadType) {
          case 'image':
            formData.append('image', this.selectedFile);
            break;
          case 'pdf':
            formData.append('pdf', this.selectedFile);
            break;
          case 'video':
            formData.append('video', this.selectedFile);

            break;
          case 'glb':
            formData.append('glb', this.selectedFile);

            break;
        }


      try {
        const token = localStorage.getItem('token');
        let uploadUrl = '';
        
        switch(this.currentUploadType) {
          case 'image':
            uploadUrl = `${this.baseUrl}/uploadImage/`;
            break;
          case 'pdf':
            uploadUrl = `${this.baseUrl}/uploadPdf/`;
            break;
          case 'video':
            uploadUrl = `${this.baseUrl}/uploadVideo/`;
            break;
          case 'glb':
            uploadUrl = `${this.baseUrl}/uploadGlb/`;
            break;
        }
        
        await axios.post(uploadUrl, formData, {
          headers: {
            'Authorization': `Token ${token}`,
            'Content-Type': 'multipart/form-data'
          }
        });
        
        this.closeDialog();
        // Refresh the data after successful upload
        await this.fetchUserData();
        
        // Show success message
        alert('ÙØ§ÛŒÙ„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¢Ù¾Ù„ÙˆØ¯ Ø´Ø¯');
      } catch (error) {
        console.error('Error uploading file:', error);
        alert('Ø®Ø·Ø§ Ø¯Ø± Ø¢Ù¾Ù„ÙˆØ¯ ÙØ§ÛŒÙ„');
      } finally {
        this.uploading = false;
      }
    }
  }
}
</script>

 
<!-- Your existing styles remain the same -->
  
  <style scoped>

.section-title {
  font-size: 16px;
  font-weight: 600;
  color: #2d3748;
  margin-top: 20px;
  margin-bottom: 10px;
  grid-column: 1 / -1;
}

/* Update the file-sidebar to accommodate more buttons */
.file-sidebar {
  width: 180px;
  display: flex;
  flex-direction: column;
  gap: 10px;
}
  .dashboard-page {
    margin-right: 360px;
    padding: 20px;
    direction: rtl;
    font-family: IRANSansXFaNum, sans-serif;
  }
  
  .content {
    background-color: #f8f9fa;
    border-radius: 20px;
    padding: 35px 80px;
    display: flex;
    flex-direction: column;
    gap: 32px;
    min-height: 80vh;
  }
  
  .header-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  
  .right-actions {
    display: flex;
    gap: 10px;
  }
  
  .subscription-button {
    background-color: #48bb78;
    color: white;
    font-size: 14px;
    padding: 8px 16px;
    border-radius: 8px;
    border: none;
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
  }
  
  .button-icon {
    width: 20px;
    height: 20px;
  }
  
  .user-info {
    display: flex;
    align-items: center;
    gap: 10px;
  }
  
  .user-name {
    font-size: 14px;
    font-weight: 500;
    color: #2d3748;
  }
  
  .avatar-box {
    width: 40px;
    height: 40px;
    border: 1px solid #e2e8f0;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: white;
  }
  
  .avatar-icon {
    width: 20px;
    height: 20px;
  }
  
  .page-title {
    font-size: 18px;
    font-weight: 600;
    color: #2d3748;
  }
  
  .section-description {
    display: flex;
    flex-direction: column;
    gap: 6px;
  }
  
  .section-title {
    font-size: 17px;
    font-weight: 700;
    color: #1a202c;
  }
  
  .section-description p {
    font-size: 14px;
    color: #4a5568;
    line-height: 1.8;
  }
  
  .file-manager-layout {
    display: flex;
    gap: 32px;
    justify-content: space-between;
    align-items: flex-start;
    flex-wrap: wrap;
  }
  
  .file-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
    gap: 24px;
    flex: 1;
    min-width: 0;
  }
  
  .file-card {
    background-color: white;
    border: 1px solid #e2e8f0;
    border-radius: 16px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    cursor: pointer;
    transition: 0.2s ease;
  }
  
  .file-card:hover {
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.07);
  }
  
  .file-image {
    width: 100%;
    height: 140px;
    object-fit: cover;
  }
  
  .file-card-info {
    padding: 12px;
    display: flex;
    flex-direction: column;
    gap: 8px;
  }
  
  .file-title {
    font-size: 14px;
    font-weight: 600;
    color: #1a202c;
    text-align: center;
  }
  
  .file-meta {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 6px;
    font-size: 12px;
    color: #718096;
  }
  
  .meta-icon {
    width: 16px;
    height: 16px;
  }
  
  .file-sidebar {
    width: 180px;
    display: flex;
    flex-direction: column;
    gap: 16px;
  }
  
  .primary-button {
    background-color: #3a57e8;
    color: white;
    font-size: 14px;
    padding: 12px;
    border-radius: 10px;
    border: none;
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: pointer;
    transition: 0.2s;
  }
  
  .primary-button:hover {
    background-color: #2e45c8;
  }
  
  .btn-icon {
    width: 16px;
    height: 16px;
  }
  
  .filter-buttons {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }
  
  .filter-btn {
    background-color: white;
    color: #1a202c;
    font-size: 13px;
    border: 1px solid #e2e8f0;
    border-radius: 8px;
    padding: 10px;
    text-align: center;
    cursor: pointer;
    transition: background-color 0.2s;
  }
  
  .filter-btn:hover {
    background-color: #edf2f7;
  }
  
  .footer {
    margin-top: 40px;
    text-align: center;
  }
  
  .text-wrapper-13 {
    font-size: 13px;
    color: white;
    font-weight: 500;
  }
  
  .logo {
    margin-top: 15px;
  }
  
  .clip-path-group {
    height: 40px;
    width: 150px;
  }








  .new-file-dialog {
  border: none;
  border-radius: 16px;
  padding: 0;
  width: 90%;
  max-width: 500px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
}

.new-file-dialog::backdrop {
  background-color: rgba(0, 0, 0, 0.5);
}

.dialog-content {
  padding: 24px;
}

.dialog-content h3 {
  margin: 0 0 20px;
  font-size: 18px;
  color: #1a202c;
  text-align: center;
}

.form-group {
  margin-bottom: 20px;
}

.form-group label {
  display: block;
  margin-bottom: 8px;
  font-size: 14px;
  color: #4a5568;
}

.form-group input[type="text"],
.form-group input[type="file"] {
  width: 100%;
  padding: 10px;
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  font-family: inherit;
}

.dialog-actions {
  display: flex;
  justify-content: space-between;
  margin-top: 30px;
}

.cancel-btn {
  background-color: #e2e8f0;
  color: #4a5568;
  border: none;
  padding: 10px 20px;
  border-radius: 8px;
  cursor: pointer;
}

.submit-btn {
  background-color: #3a57e8;
  color: white;
  border: none;
  padding: 10px 20px;
  border-radius: 8px;
  cursor: pointer;
}

.submit-btn:disabled {
  background-color: #a0aec0;
  cursor: not-allowed;
}

.image-preview-dialog {
  border: none;
  border-radius: 12px;
  padding: 0;
  max-width: 70%;
  max-height: 80%;
  width: auto;
  height: auto;
}

.preview-content {
  position: relative;
  padding: 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.close-preview {
  position: absolute;
  top: 10px;
  right: 10px;
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  color: #333;
}

.preview-image {
  max-width: 100%;
  max-height: 70vh;
  margin-bottom: 20px;
}

.preview-actions {
  display: flex;
  gap: 10px;
}

.download-btn, .delete-btn {
  padding: 8px 16px;
  border-radius: 6px;
  border: none;
  cursor: pointer;
  font-weight: 500;
}

.download-btn {
  background-color: #3a57e8;
  color: white;
}

.delete-btn {
  background-color: #ff4d4f;
  color: white;
}




/* pdf preview */
.pdf-preview-container {
  width: 100%;
  max-width: 800px;
  height: 70vh;
  overflow: auto;
  margin-bottom: 20px;
  border: 1px solid #ddd;
}

.pdf-preview {
  width: 100%;
  height: 100%;
}

/* Adjust dialog size for PDFs */
.image-preview-dialog[data-type="pdf"] {
  width: 80%;
  height: 80%;
}
/* pdf preview */



/* Base dialog styles */
.file-preview-dialog {
  border: none;
  border-radius: 12px;
  padding: 0;
  max-width: 90%;
  max-height: 90%;
  width: auto;
  height: auto;
}

.preview-content {
  position: relative;
  padding: 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.close-preview {
  position: absolute;
  top: 10px;
  right: 10px;
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  color: #333;
}

/* Image preview */
.preview-file[data-type="image"] {
  max-width: 100%;
  max-height: 70vh;
  margin-bottom: 20px;
}

/* PDF preview */
.pdf-preview-container {
  width: 100%;
  max-width: 800px;
  height: 70vh;
  overflow: auto;
  margin-bottom: 20px;
  border: 1px solid #ddd;
}

.pdf-preview {
  width: 100%;
  height: 100%;
}

/* Video preview */
.video-preview-container {
  width: 100%;
  max-width: 800px;
  margin-bottom: 20px;
}

.video-preview {
  width: 100%;
  max-height: 70vh;
}

/* 3D Model preview */
.model-preview-container {
  width: 100%;
  height: 70vh;
  max-width: 800px;
  margin-bottom: 20px;
}

.model-preview {
  width: 100%;
  height: 100%;
}

/* Action buttons */
.preview-actions {
  display: flex;
  gap: 10px;
}

.download-btn, .delete-btn {
  padding: 8px 16px;
  border-radius: 6px;
  border: none;
  cursor: pointer;
  font-weight: 500;
}

.download-btn {
  background-color: #3a57e8;
  color: white;
}

.delete-btn {
  background-color: #ff4d4f;
  color: white;
}








.dialog-content {
  /* Prevent margin collapse that could interfere with click detection */
  display: inline-block;
  /* Rest of your existing dialog content styles */
}

.file-preview-dialog::backdrop {
  /* Makes the backdrop clickable */
  background: rgba(0, 0, 0, 0.5);
  cursor: pointer;
}













.container {
  display: flex;
  flex-direction: column;
  width: 100%;
  max-width: 1200px;
  margin: 0 auto;
  padding: 20px;
}

/* Header styles */
.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.btn-buy {
  background-color: #4caf50;
  color: white;
  border: none;
  padding: 10px 20px;
  cursor: pointer;
}

.search-bar input {
  padding: 10px;
  width: 300px;
}

/* Main content styles */
.main-content {
  display: flex;
  flex-direction: column;
}

.team h2 {
  font-size: 24px;
  margin-bottom: 10px;
}

.team h3 {
  font-size: 20px;
  margin-bottom: 10px;
}

.team p {
  font-size: 16px;
  margin-bottom: 20px;
}

.user-list {
  display: flex;
  flex-direction: column;
}

.user {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px;
  border-bottom: 1px solid #ddd;
}

.user-avatar {
  width: 50px;
  height: 50px;
  border-radius: 50%;
}

.user-info {
  flex-grow: 1;
  margin-left: 10px;
}

.btn-remove {
  background-color: #f44336;
  color: white;
  border: none;
  padding: 8px 16px;
  cursor: pointer;
}















.tab-buttons {
  display: flex;
  gap: 12px;
  margin-top: 16px;
  margin-bottom: 16px;
}

.tab-btn {
  background: none;
  border: none;
  color: gray;
  font-size: 14px;
  padding: 8px 16px;
  cursor: pointer;
  border-bottom: 2px solid transparent;
  transition: all 0.2s ease-in-out;
}

.tab-btn.active {
  color: #3a57e8;
  border-bottom: 2px solid #3a57e8;
}

.tab-content {
  display: flex;
  flex-wrap: wrap;
  gap: 16px;
}

.card {
  background-color: white;
  border: 1px solid #e2e8f0;
  border-radius: 12px;
  padding: 20px;
  min-width: 200px;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
}

.license-card {
  max-width: 1600px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.buy-subscription {
  color: #48bb78; /* Tailwind-style green */
  font-weight: 600;
  cursor: pointer;
}


.user-cards {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
  margin-top: 20px;
      height: 280px;
}

.user-card {
  background: #fff;
  border-radius: 16px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.05);
     width: 440px;
    height: 158px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
 
  position: relative;
}

.user-info-box {
  text-align: right;
  display: flex;
  flex-direction: column;
  gap: 6px;
  margin-top: 20px;
}

.user-role {
  color: #3a57e8;
  font-weight: 600;
}

.user-name {
  font-weight: 700;
  font-size: 16px;
}

.user-avatar {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  align-self: flex-end;
  margin-top: 10px;
}
 

.user-actions button {
  background: none;
  border: none;
  color: white;
  font-size: 16px;
  cursor: pointer;
}

.add-card {
  display: flex;
  align-items: center;
  justify-content: center;
  color: #3a57e8;
  font-weight: 600;
  font-size: 14px;
  border: 2px dashed #3a57e8;
  width: 440px;
    height: 158px;
}

.add-text {
  text-align: center;
}

/* dialog */
.add-user-dialog {
  border: none;
  border-radius: 12px;
  width: 90%;
  max-width: 500px;
  padding: 0;
}

.dialog-header {
  background: black;
  color: white;
  padding: 16px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-top-left-radius: 12px;
  border-top-right-radius: 12px;
}

.dialog-body {
  padding: 24px;
  direction: rtl;
}

.form-fields {
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin-top: 20px;
}

.form-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
    

}

.form-row input {
  flex: 1;
  padding: 8px;
  border-radius: 6px;
  border: 1px solid #ccc;
    max-width: 300px;
    margin-left: 19px;
}

.switch-row input[type="checkbox"] {
  width: 20px;
  height: 20px;
}

.dialog-actions {
  display: flex;
  justify-content: space-between;
  margin-top: 24px;
}

.confirm-btn {
  background: #3a57e8;
  color: white;
  border: none;
  padding: 10px 20px;
  border-radius: 8px;
}

.cancel-btn {
  background: #e2e8f0;
  border: none;
  padding: 10px 20px;
  border-radius: 8px;
}

/* dialog  */




/* tab 2 */
.access-container {
  direction: rtl;
  font-family: IRANSansXFaNum, sans-serif;
  padding: 20px;
  background-color: #f9f9fb;
      width: -webkit-fill-available;
}

.access-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
}

.header-text h3 {
  font-size: 20px;
  font-weight: 700;
  color: #1a202c;
  margin-bottom: 6px;
}

.header-text p {
  color: #4a5568;
  font-size: 14px;
}

.lock-icon {
  width: 40px;
  height: 40px;
}

.primary-button {
  background-color: #3a57e8;
  color: white;
  border: none;
  padding: 12px 24px;
  font-size: 14px;
  border-radius: 10px;
  margin-bottom: 30px;
  cursor: pointer;
}

.info-cards {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
}

.info-card {
  background: white;
  border-radius: 16px;
  padding: 20px;
  width: 100%;
  max-width: 300px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.05);
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}

.info-card h4 {
  font-size: 16px;
  font-weight: 600;
  margin-bottom: 12px;
}

.info-card p {
  font-size: 14px;
  color: #4a5568;
  margin-bottom: 16px;
  line-height: 1.7;
}

.secondary-button {
  background-color: #3a57e8;
  color: white;
  border: none;
  padding: 10px 16px;
  font-size: 13px;
  border-radius: 8px;
  cursor: pointer;
}

/* tab 2 */












 

.user-card-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 16px;
}

.user-avatar {
  width: 70px;
      height: 86px;
  border-radius: 50%;
  object-fit: cover;
  flex-shrink: 0;
}

.user-info-box {
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  
  flex: 1;
  text-align: right;
  gap: 4px;
}

.user-name {
  font-weight: 700;
  font-size: 16px;
}

.user-email, .user-role, .user-version {
  font-size: 14px;
  color: #4a5568;
}

.user-footer {
  background: #3a57e8;
  color: #fff;
  border-radius: 0 0 12px 12px;
  padding: 10px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  /* margin-top: 20px; */
}

.user-actions button {
  background: none;
  border: none;
  color: white;
  font-size: 16px;
  cursor: pointer;
}





.plan-card {
  background-color: white;
  border: 1px solid #e2e8f0;
  border-radius: 16px;
  padding: 20px;
  width: 250px;
  text-align: center;
  box-shadow: 0 2px 10px rgba(0,0,0,0.05);
}

.plan-card h4 {
  font-size: 18px;
  color: #1a202c;
  margin-bottom: 10px;
}

.plan-card p {
  font-size: 16px;
  color: #4a5568;
  margin-bottom: 20px;
  line-height: 1.6;
}




</style>
  